<!DOCTYPE html>
<html lang="en">
    <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>alshin - logrotate 归档log</title>
    <meta name="description" content="">

    <link rel="stylesheet" href="/assets/css/bootstrap.css">
    <link rel="stylesheet" href="/assets/css/animate.css">
    <link rel="stylesheet" href="/assets/css/font-awesome.min.css">
    <link rel="stylesheet" href="/assets/css/font.css">
    <link rel="stylesheet" href="/assets/css/landing.css">
    <link rel="stylesheet" href="/assets/css/app.css">
    <link rel="stylesheet" href="/assets/css/highlight.css">
    <link rel="stylesheet" href="/assets/css/custom.css">

    <script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan style='display:none;' id='cnzz_stat_icon_1262884701'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s22.cnzz.com/z_stat.php%3Fid%3D1262884701' type='text/javascript'%3E%3C/script%3E"));</script>
</head>

    <body>
        <section id="wrapper">
            <article class="post">
                <header>
                    <h1>logrotate 归档log</h1>
                    <h2 class="headline">29 Sep 2017</h2>
                </header>
                <!--                                                                                                                                                                                -->
                <section id="post-body">
                    <blockquote>
  <p>logrotate是linux下的一个服务。它可以自动对日志进行截断（或轮循）、压缩以及删除旧的日志文件。</p>
</blockquote>

<h3 id="logrotate-配置文件">logrotate 配置文件</h3>

<p>配置文件路径 <code>/etc/logrotate.d</code>,在目录创建配置文件.</p>

<pre><code class="language-shell">/www/project/shared/log/production.log {
    weekly
    rotate 12
    missingok
    notifempty
    compress
    dateext
    delaycompress
    copytruncate
}
</code></pre>

<h3 id="cron-定时任务">Cron 定时任务</h3>

<p>语法</p>

<pre><code> - – – – -
 | | | | |
 | | | | +—– Day of week (0–6) (Sunday=0) or Sun, Mon, Tue,…
 | | | +———- Month (1–12) or Jan, Feb,…
 | | +————-— Day of month (1–31)
 | +——————– Hour (0–23)
 +————————- Minute (0–59)

</code></pre>

<p>cron 轮询例子</p>

<pre><code># /usr/sbin/logrotate -f /etc/logrotate.d/nginx  // 未到时间或者未到切割条件，强制切割
# /usr/sbin/logrotate -d -f /etc/logrotate.d/nginx // 输出切割debug信息

</code></pre>

<p>查看正在进行的 logrotate <code>cat /var/lib/logrotate/status</code>.</p>

<h3 id="参考资料">参考资料</h3>

<ul>
  <li>
    <p><a href="http://www.jianshu.com/p/ea7c2363639c">http://www.jianshu.com/p/ea7c2363639c</a></p>
  </li>
  <li>
    <p><a href="http://www.jianshu.com/p/0137db63b91d">http://www.jianshu.com/p/0137db63b91d</a></p>
  </li>
</ul>


                </section>
            </article>

            <div id="disqus_thread"></div>
            <script type="text/javascript">
                var disqus_shortname = 'alshin';
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
            <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

            <footer id="footer">
                <div id="social">
                    <a class="symbol" href="https://github.com/yundshang">
                      <i class="fa fa-github"></i>
                    </a>
                    <a class="symbol" href="https://twitter.com">
                      <i class="fa fa-twitter"></i>
                    </a>
                    <a class="symbol" href="http://weibo.com">
                      <i class="fa fa-weibo"></i>
                    </a>
                </div>
                <p class="small">
                    © 版权所有 alshin
                </p>
            </footer>
        </section>

    </body>
</html>
