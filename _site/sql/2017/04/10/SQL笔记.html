<!DOCTYPE html>
<html lang="en">
    <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>alshin - SQL笔记</title>
    <meta name="description" content="">

    <link rel="stylesheet" href="/blog/assets/css/bootstrap.css">
    <link rel="stylesheet" href="/blog/assets/css/animate.css">
    <link rel="stylesheet" href="/blog/assets/css/font-awesome.min.css">
    <link rel="stylesheet" href="/blog/assets/css/font.css">
    <link rel="stylesheet" href="/blog/assets/css/landing.css">
    <link rel="stylesheet" href="/blog/assets/css/app.css">
    <link rel="stylesheet" href="/blog/assets/css/highlight.css">
    <link rel="stylesheet" href="/blog/assets/css/custom.css">

    <link rel="canonical" href="/blog/sql/2017/04/10/SQL%E7%AC%94%E8%AE%B0.html">
    <script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan style='display:none;' id='cnzz_stat_icon_1259096643'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s4.cnzz.com/z_stat.php%3Fid%3D1259096643' type='text/javascript'%3E%3C/script%3E"));</script>
</head>

    <body>
        <section id="wrapper">
            <article class="post">
                <header>
                    <h1>SQL笔记</h1>
                    <h2 class="headline">10 Apr 2017</h2>
                </header>
                <section id="post-body">
                    <blockquote>
<p>SQL连接可以分为内连接、外连接、交叉连接。</p>
</blockquote>

<h2 id="内连接">内连接</h2>

<ul>
<li><p>等值连接：在连接条件中使用等于号(=)运算符比较被连接列的列值，其查询结果中列出被连接表中的所有列，包括其中的重复列。</p></li>
<li><p>不等值连接：在连接条件使用除等于运算符以外的其它比较运算符比较被连接的列的列值。这些运算符包括&gt;、&gt;=、&lt;=、&lt;、!&gt;、!&lt;和&lt;&gt;。</p></li>
<li><p>自然连接：在连接条件中使用等于(=)运算符比较被连接列的列值，但它使用选择列表指出查询结果集合中所包括的列，并删除连接表中的重复列。</p></li>
</ul>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby">   <span class="nb">select</span> <span class="o">*</span> <span class="n">from</span> <span class="n">book</span> <span class="n">as</span> <span class="n">a</span><span class="p">,</span><span class="n">stu</span> <span class="n">as</span> <span class="n">b</span> <span class="n">where</span> <span class="n">a</span><span class="o">.</span><span class="n">sutid</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">stuid</span> <span class="nb">select</span> <span class="o">*</span> <span class="n">from</span> <span class="n">book</span> <span class="n">as</span> <span class="n">a</span> <span class="n">inner</span> <span class="n">join</span> <span class="n">stu</span> <span class="n">as</span> <span class="n">b</span> <span class="n">on</span> <span class="n">a</span><span class="o">.</span><span class="n">sutid</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">stuid</span>
</code></pre></div>
<h2 id="外连接">外连接</h2>

<ul>
<li>左连接：是以左表为基准，将a.stuid = b.stuid的数据进行连接，然后将左表没有的对应项显示，右表的列为NULL</li>
</ul>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby">   <span class="nb">select</span> <span class="o">*</span> <span class="n">from</span> <span class="n">book</span> <span class="n">as</span> <span class="n">a</span> <span class="n">left</span> <span class="n">join</span> <span class="n">stu</span> <span class="n">as</span> <span class="n">b</span> <span class="n">on</span> <span class="n">a</span><span class="o">.</span><span class="n">sutid</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">stuid</span>
</code></pre></div>
<ul>
<li>右连接：是以右表为基准，将a.stuid = b.stuid的数据进行连接，然以将右表没有的对应项显示，左表的列为NULL</li>
</ul>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby">   <span class="nb">select</span> <span class="o">*</span> <span class="n">from</span> <span class="n">book</span> <span class="n">as</span> <span class="n">a</span> <span class="n">right</span> <span class="n">join</span> <span class="n">stu</span> <span class="n">as</span> <span class="n">b</span> <span class="n">on</span> <span class="n">a</span><span class="o">.</span><span class="n">sutid</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">stuid</span>
</code></pre></div>
<ul>
<li>全连接：完整外部联接返回左表和右表中的所有行。当某行在另一个表中没有匹配行时，则另一个表的选择列表列包含空值。如果表之间有匹配行，则整个结果集行包含基表的数据值。</li>
</ul>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="nb">select</span> <span class="o">*</span> <span class="n">from</span> <span class="n">book</span> <span class="n">as</span> <span class="n">a</span> <span class="n">full</span> <span class="n">outer</span> <span class="n">join</span> <span class="n">stu</span> <span class="n">as</span> <span class="n">b</span> <span class="n">on</span> <span class="n">a</span><span class="o">.</span><span class="n">sutid</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">stuid</span>
</code></pre></div>
<h2 id="交叉连接">交叉连接</h2>

<ul>
<li>交叉连接：交叉联接返回左表中的所有行，左表中的每一行与右表中的所有行组合。交叉联接也称作笛卡尔积。</li>
</ul>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="nb">select</span> <span class="o">*</span> <span class="n">from</span> <span class="n">book</span> <span class="n">as</span> <span class="n">a</span> <span class="n">cross</span> <span class="n">join</span> <span class="n">stu</span> <span class="n">as</span> <span class="n">b</span> <span class="n">order</span> <span class="n">by</span> <span class="n">a</span><span class="o">.</span><span class="n">id</span>
</code></pre></div>
<h2 id="子查询">子查询</h2>

<blockquote>
<p>子查询（Sub Query）或者说内查询（Inner Query），也可以称作嵌套查询（Nested Query），是一种嵌套在其他 SQL 查询的 WHERE 子句中的查询。</p>
</blockquote>

<ul>
<li>单行子查询</li>
</ul>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"> <span class="nb">select</span> <span class="n">ename</span><span class="p">,</span><span class="n">deptno</span><span class="p">,</span><span class="n">sal</span> <span class="n">from</span> <span class="n">emp</span> <span class="n">where</span> <span class="n">deptno</span><span class="o">=</span><span class="p">(</span><span class="nb">select</span> <span class="n">deptno</span> <span class="n">from</span> <span class="n">dept</span> <span class="n">where</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;NEW YORK&#39;</span><span class="p">)</span><span class="err">；</span>
</code></pre></div>
<ul>
<li>多行子查询</li>
</ul>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"> <span class="nb">select</span> <span class="n">ename</span><span class="p">,</span><span class="n">job</span><span class="p">,</span><span class="n">sal</span> <span class="no">FROM</span> <span class="no">EMP</span> <span class="no">WHERE</span> <span class="n">deptno</span> <span class="k">in</span> <span class="p">(</span> <span class="no">SELECT</span> <span class="n">deptno</span> <span class="no">FROM</span> <span class="n">dept</span> <span class="no">WHERE</span> <span class="n">dname</span> <span class="no">LIKE</span> <span class="s1">&#39;A%&#39;</span><span class="p">)</span><span class="err">；</span>
</code></pre></div>
<ul>
<li>多列子查询</li>
</ul>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"> <span class="no">SELECT</span> <span class="n">deptno</span><span class="p">,</span><span class="n">ename</span><span class="p">,</span><span class="n">job</span><span class="p">,</span><span class="n">sal</span> <span class="no">FROM</span> <span class="no">EMP</span> <span class="no">WHERE</span> <span class="p">(</span><span class="n">deptno</span><span class="p">,</span><span class="n">sal</span><span class="p">)</span> <span class="no">IN</span> <span class="p">(</span><span class="no">SELECT</span> <span class="n">deptno</span><span class="p">,</span><span class="no">MAX</span><span class="p">(</span><span class="n">sal</span><span class="p">)</span> <span class="no">FROM</span> <span class="no">EMP</span> <span class="no">GROUP</span> <span class="no">BY</span> <span class="n">deptno</span><span class="p">)</span><span class="err">；</span>
</code></pre></div>
<ul>
<li>内联视图子查询</li>
</ul>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"> <span class="no">SELECT</span> <span class="n">ename</span><span class="p">,</span><span class="n">job</span><span class="p">,</span><span class="n">sal</span><span class="p">,</span><span class="n">rownum</span> <span class="no">FROM</span> <span class="p">(</span><span class="no">SELECT</span> <span class="n">ename</span><span class="p">,</span><span class="n">job</span><span class="p">,</span><span class="n">sal</span> <span class="no">FROM</span> <span class="no">EMP</span> <span class="no">ORDER</span> <span class="no">BY</span> <span class="n">sal</span><span class="p">)</span><span class="err">；</span>
 <span class="no">SELECT</span> <span class="n">ename</span><span class="p">,</span><span class="n">job</span><span class="p">,</span><span class="n">sal</span><span class="p">,</span><span class="n">rownum</span> <span class="no">FROM</span> <span class="p">(</span> <span class="no">SELECT</span> <span class="n">ename</span><span class="p">,</span><span class="n">job</span><span class="p">,</span><span class="n">sal</span> <span class="no">FROM</span> <span class="no">EMP</span> <span class="no">ORDER</span> <span class="no">BY</span> <span class="n">sal</span><span class="p">)</span> <span class="no">WHERE</span> <span class="n">rownum</span><span class="o">&lt;=</span><span class="mi">5</span><span class="err">；</span>
</code></pre></div>
<ul>
<li>在HAVING子句中使用子查询</li>
</ul>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby">  <span class="no">SELECT</span> <span class="n">deptno</span><span class="p">,</span><span class="n">job</span><span class="p">,</span><span class="no">AVG</span><span class="p">(</span><span class="n">sal</span><span class="p">)</span> <span class="no">FROM</span> <span class="no">EMP</span> <span class="no">GROUP</span> <span class="no">BY</span> <span class="n">deptno</span><span class="p">,</span><span class="n">job</span> <span class="no">HAVING</span> <span class="no">AVG</span><span class="p">(</span><span class="n">sal</span><span class="p">)</span><span class="o">&gt;</span><span class="p">(</span><span class="no">SELECT</span> <span class="n">sal</span> <span class="no">FROM</span> <span class="no">EMP</span> <span class="no">WHERE</span> <span class="n">ename</span><span class="o">=</span><span class="s1">&#39;MARTIN&#39;</span><span class="p">)</span><span class="err">；</span>
</code></pre></div>
                </section>
            </article>

            <div id="disqus_thread"></div>
            <script type="text/javascript">
                var disqus_shortname = 'alshin';
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
            <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

            <footer id="footer">
                <div id="social">
                    <a class="symbol" href="https://github.com/yundshang">
                      <i class="fa fa-github"></i>
                    </a>
                    <a class="symbol" href="https://twitter.com">
                      <i class="fa fa-twitter"></i>
                    </a>
                    <a class="symbol" href="http://weibo.com">
                      <i class="fa fa-weibo"></i>
                    </a>
                </div>
                <p class="small">
                    © 版权所有 alshin
                </p>
            </footer>
        </section>

    </body>
</html>
